<!DOCTYPE html><html><head>
      <title>week11_notes</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///F:\_PortableApps\VSCode-1.33.0\data\extensions\shd101wyy.markdown-preview-enhanced-0.3.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
      
      
      
      
      
      
      
      
      

      <style> 
      pre{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;padding:1em;margin:.5em 0;overflow:auto;line-height:1.5;tab-size:4;hyphens:none;color:#c5c8c6;background-color:#27292c !important;border:#43484c;border-radius:3px}pre[class*="language-"]{padding:1em}code[class*="language-"] .token.comment,pre[class*="language-"] .token.comment,code[class*="language-"] .token.prolog,pre[class*="language-"] .token.prolog,code[class*="language-"] .token.doctype,pre[class*="language-"] .token.doctype,code[class*="language-"] .token.cdata,pre[class*="language-"] .token.cdata{color:#7C7C7C}code[class*="language-"] .token.punctuation,pre[class*="language-"] .token.punctuation{color:#96CBFE}code[class*="language-"] .namespace,pre[class*="language-"] .namespace{opacity:.7}code[class*="language-"] .token.constant,pre[class*="language-"] .token.constant{color:#99CC99}code[class*="language-"] .token.boolean,pre[class*="language-"] .token.boolean,code[class*="language-"] .token.number,pre[class*="language-"] .token.number,code[class*="language-"] .token.function-name,pre[class*="language-"] .token.function-name{color:#FF73FD}code[class*="language-"] .token.tag,pre[class*="language-"] .token.tag{color:#96CBFE}code[class*="language-"] .token.selector,pre[class*="language-"] .token.selector{color:#96CBFE}code[class*="language-"] .token.attr-name,pre[class*="language-"] .token.attr-name{color:#C6C5FE}code[class*="language-"] .token.string,pre[class*="language-"] .token.string{color:#A8FF60}code[class*="language-"] .token.char,pre[class*="language-"] .token.char{color:#FF8000}code[class*="language-"] .token.entity,pre[class*="language-"] .token.entity{color:#FFD2A7}code[class*="language-"] .token.url,pre[class*="language-"] .token.url{color:#7C7C7C}code[class*="language-"] .token.operator,pre[class*="language-"] .token.operator{color:#EDEDED}code[class*="language-"] .token.atrule,pre[class*="language-"] .token.atrule,code[class*="language-"] .token.attr-value,pre[class*="language-"] .token.attr-value,code[class*="language-"] .token.keyword,pre[class*="language-"] .token.keyword{color:#CFCB90}code[class*="language-"] .token.function,pre[class*="language-"] .token.function{color:#FFD2A7}code[class*="language-"] .token.class-name,pre[class*="language-"] .token.class-name{color:#FFD2A7}code[class*="language-"] .token.variable,pre[class*="language-"] .token.variable{color:#C6C5FE}code[class*="language-"] .token.regex,pre[class*="language-"] .token.regex,code[class*="language-"] .token.important,pre[class*="language-"] .token.important{color:#E9C062}code[class*="language-"] .token.important,pre[class*="language-"] .token.important,code[class*="language-"] .token.bold,pre[class*="language-"] .token.bold{font-weight:bold}code[class*="language-"] .token.italic,pre[class*="language-"] .token.italic{font-style:italic}code[class*="language-"] .token.entity,pre[class*="language-"] .token.entity{cursor:help}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:rgba(153,122,102,0.08);background:linear-gradient(to right, rgba(153,122,102,0.1) 70%, rgba(153,122,102,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:rgba(153,122,102,0.4);color:#f5f2f0;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px white}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#ccc;background-color:#141414;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#fff}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#a3a3a3}html body strong{color:#fff}html body del{color:#a3a3a3}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#a3a3a3;border-left:4px solid #3d3d3d}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#3d3d3d;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#fff}html body table td,html body table th{border:1px solid #3d3d3d;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#fff;background-color:#282828;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#3d3d3d;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#fff;border:1px solid #3d3d3d;border-bottom:2px solid #2e2e2e;padding:2px 4px;background-color:#282828;border-radius:3px}@media print{html body{background-color:#141414}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#fff;page-break-after:avoid}html body blockquote{color:#a3a3a3}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
 
      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview   ">
      <h1 class="mume-header" id="week-11-time-text-collisions">Week 11 - Time, text, collisions</h1>

<p>Hitting as many useful assignment-finishing tools as we can.</p>
<div class="code-chunk" data-id="code-chunk-id-0" data-cmd="toc"><div class="input-div"><div class="btn-group"><div class="run-btn btn"><span>&#x25B6;&#xFE0E;</span></div><div class="run-all-btn btn">all</div></div><div class="status">running...</div></div><div class="output-div"></div></div><ol>
<li><a href="#week-11---time-text-collisions">Week 11 - Time, text, collisions</a>
<ol>
<li><a href="#todo">Todo</a></li>
<li><a href="#resources">Resources</a></li>
<li><a href="#scoringdisplaying-text">Scoring/Displaying text</a>
<ol>
<li><a href="#adding-ui-canvas-and-text">Adding UI canvas and text</a></li>
<li><a href="#editing-tmp-text-in-script">Editing TMP text in script</a></li>
</ol>
</li>
<li><a href="#missiles-come-in-waves-in-each-level">Missiles come in waves in each level</a>
<ol>
<li><a href="#psuedocoding-the-waves">Psuedocoding the waves</a></li>
</ol>
</li>
<li><a href="#doing-things-over-time">Doing things over time</a>
<ol>
<li><a href="#things-that-need-timing">Things that need timing</a></li>
<li><a href="#ways-to-time">Ways to time</a></li>
<li><a href="#invoke">Invoke</a></li>
<li><a href="#update-and-timedeltatime">Update and time.deltaTime.</a></li>
<li><a href="#coroutines">Coroutines</a>
<ol>
<li><a href="#waves-with-a-coroutine">Waves with a coroutine</a></li>
<li><a href="#side-notes-on-coroutines-and-threads-for-the-curious">Side notes on coroutines and threads for the curious</a></li>
</ol>
</li>
</ol>
</li>
<li><a href="#missiles">Missiles</a>
<ol>
<li><a href="#aiming-things-at-things">Aiming things at things</a></li>
<li><a href="#moving-at-a-given-speed">Moving at a given speed</a></li>
<li><a href="#missile-explosions">Missile explosions</a></li>
<li><a href="#hitting-things">Hitting things</a></li>
</ol>
</li>
</ol>
</li>
</ol>
<h2 class="mume-header" id="todo">Todo</h2>

<ul>
<li>Finalise, as much as you can, hacknplan tasks
<ul>
<li>You&apos;ll notice the burndown doesn&apos;t progress if you&apos;re still adding new tasks at the rate you&apos;re finishing others</li>
</ul>
</li>
<li>Game should be basically done by next class.</li>
</ul>
<h2 class="mume-header" id="resources">Resources</h2>

<p>Collisions:</p>
<ul>
<li>Official docs <a href="https://docs.unity3d.com/ScriptReference/MonoBehaviour.OnCollisionEnter2D.html">https://docs.unity3d.com/ScriptReference/MonoBehaviour.OnCollisionEnter2D.html</a></li>
<li>Colliders and triggers <a href="https://youtu.be/RxG7YYEdmVE">https://youtu.be/RxG7YYEdmVE</a></li>
</ul>
<p>Timers:</p>
<ul>
<li>Blog tute: <a href="https://medium.com/@jaredehalpern/build-a-reusable-timer-in-unity-to-control-explosions-and-other-fun-stuff-too-1689210b733">Build a reusable timer</a></li>
<li>Docs: <a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/MonoBehaviour.StartCoroutine.html">StartCoroutine</a></li>
<li>Docs: <a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/WaitForSeconds.html">Waiting for game seconds</a></li>
<li>Docs: <a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference/WaitForSecondsRealtime.html">Waiting for real world seconds</a></li>
</ul>
<p>TextMeshPro:</p>
<ul>
<li>Unity Blog: <a href="https://blogs.unity3d.com/2018/10/16/making-the-most-of-textmesh-pro-in-unity-2018/">https://blogs.unity3d.com/2018/10/16/making-the-most-of-textmesh-pro-in-unity-2018/</a></li>
</ul>
<h2 class="mume-header" id="scoringdisplaying-text">Scoring/Displaying text</h2>

<p>We&apos;re used to text being an everyday thing in our apps. Word, web browsers, photoshop and so on. But these are inherently 2D apps. How are fonts drawn in a world of polygons and textures?</p>
<p>Traditionally:</p>
<ol>
<li>Use an image editor to <strong>place all the characters and symbols you want in a bitmap</strong></li>
<li>Arrange them all to fit in a power of 2 square (256x256, etc)</li>
<li><strong>Define rectangles for each letter</strong> in your game engine</li>
<li>Create a material with the font atlas as a teture</li>
<li>For each letter in a string <strong>generate a quad with UV coordinates</strong> to match the letter&apos;s rectangle, add the font material.</li>
</ol>
<p><img src="assets/week11/textmesh_atlas.jpg" alt="Font atlas"></p>
<p>That&apos;s a lot of work. So someone made TextMeshPro for Unity, and Unity bought it.</p>
<blockquote>
<p>TextMeshPro has an atlas generator for the first 3 steps, and components for the rest.</p>
</blockquote>
<p><img src="assets/week11/textmesh_font_asset_creator.jpg" alt="asset creator"><br>
<img src="assets/week11/textmesh_components.png" alt="components"></p>
<h3 class="mume-header" id="adding-ui-canvas-and-text">Adding UI canvas and text</h3>

<p>Unity UIs are contained within a component called a <strong>canvas</strong>. It does a lot, including fitting our UI to our window and adapting to resolution changes.</p>
<ul>
<li>Creating a UI Canvas</li>
<li>Creating tex mesh pro (TMP) label</li>
</ul>
<h3 class="mume-header" id="editing-tmp-text-in-script">Editing TMP text in script</h3>

<pre data-role="codeBlock" data-info="cs" class="language-csharp"><span class="token comment">// Code from unity incoming</span>

</pre><hr>
<h2 class="mume-header" id="missiles-come-in-waves-in-each-level">Missiles come in waves in each level</h2>

<p>A level in Missile Command consists of <em>n</em> wave of missiles, where <em>n=5</em> last time I checked. It might vary?</p>
<ul>
<li>Within each wave you spawn <em>n</em> missiles.</li>
<li>It&apos;s just a matter of knowing how many you want to launch, from what point in space, and in what direction.</li>
</ul>
<blockquote>
<p>You could handle these waves in a special <code>LevelManager</code>, directly in a large <code>GameManager</code>, in a <code>GameModel</code>: Choose the structure you understand best and think you have time to finish.</p>
</blockquote>
<hr>
<h3 class="mume-header" id="psuedocoding-the-waves">Psuedocoding the waves</h3>

<p>Here&apos;s one way to break it down. <strong>It&apos;s just the missile firing and tracking loop,</strong> without collisions, scoring, a &quot;click to play&quot; or final game over stats. All those can come <strong>once I have missiles in the air.</strong></p>
<p>You might think of a better way, or just one that suits you better.</p>
<pre data-role="codeBlock" data-info class="language-"><code>//////// LevelManager -

A MissileShot has a launch angle and position
A Wave has all the missile shots for one wave and a duration
A Level has all the waves for a level
A list of levels exists

When asked to:
  
  grab next level from list
  while there are waves left in level
    
    for each MissileShot
      create an alien missile from a prefab, add to a list
      add listener for demise of any missiles, which removes from list
      Rotate and position it accordingly
      Fire it
      Publicise the info with a link to the missile
      
    Wait for wave duration

  loop for remaining waves

  while there are still missiles in list
    listen for and remove any remaining missiles
  loop while
  announce level complete

//////////////// Game Manager/Model:
start game

While player isn&apos;t dead
  Ask Level Manager to kick off a level
  Listen for level complete
  Show results of level, wait a bit
loop

show final result.
play again?
</code></pre><hr>
<h2 class="mume-header" id="doing-things-over-time">Doing things over time</h2>

<p>We&apos;ve all played games where time is critical. Time to finish a level, time per lap, time to get out of a space station before it blows.</p>
<p>Timings affect us in lots of other scenarios. Cooldown times, facility/vehicle upgrade and repair times, rounds fired per second.</p>
<h3 class="mume-header" id="things-that-need-timing">Things that need timing</h3>

<p>Potential things that need timing</p>
<blockquote>
<ul>
<li>From press play</li>
<li>From level finish (last missile destroyed) till next level, showing results</li>
<li>From game over till game over graphics appear, play out and show play again or return to home screen</li>
</ul>
</blockquote>
<p>How do we specify a series of times, say:</p>
<ol>
<li>0s</li>
<li>1.3s,</li>
<li>3.1s</li>
</ol>
<h3 class="mume-header" id="ways-to-time">Ways to time</h3>

<p><code>Invoke</code>, counting time in <code>Update()</code>, <code>StartCoroutine</code> and more.</p>
<h3 class="mume-header" id="invoke">Invoke</h3>

<p>Invoke will call a function after a given delay. This doesn&apos;t pause your program like sleep would in c++. Execution continues.</p>
<p>From <a href="https://stackoverflow.com/questions/30056471/how-make-the-script-wait-sleep-in-a-simple-way-in-unity">Stack Overflow</a></p>
<pre data-role="codeBlock" data-info="cs" class="language-csharp"><span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token string">&quot;feedDog&quot;</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Will feed dog after 5 seconds&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">feedDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Now feeding Dog&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><hr>
<h3 class="mume-header" id="update-and-timedeltatime">Update and time.deltaTime.</h3>

<p>Basically counting time as update executes over and over. Then after a certain time, doing something.</p>
<ul>
<li>This is okay for the same thing happening at intervals.</li>
<li>A sequence of things happening with various timings gets trickier/messier. Maybe a combo of a list and a function?</li>
</ul>
<p>From <a href="https://stackoverflow.com/questions/30056471/how-make-the-script-wait-sleep-in-a-simple-way-in-unity">Stack Overflow</a></p>
<pre data-role="codeBlock" data-info="cs" class="language-csharp"><span class="token keyword">float</span> timer <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">bool</span> timerReached <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>

<span class="token comment">// Modified from stackoverflow a little</span>
<span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timerReached<span class="token punctuation">)</span>
    timer <span class="token operator">+=</span> Time<span class="token punctuation">.</span>deltaTime<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Done waiting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">feedDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">//Set to false so that We don&apos;t run this again</span>
      timerReached <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">feedDog</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Now feeding Dog&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><h3 class="mume-header" id="coroutines">Coroutines</h3>

<p>What if we could pause a function and come back to it after a given interval. That way our timed things could all be encapsulated in one function, and we could do stuff while it&apos;s paused. A coroutine is a function, but it&apos;s also a similar to a process that can be stopped and started, returning control to our main execution.</p>
<p>From <a href="https://stackoverflow.com/questions/30056471/how-make-the-script-wait-sleep-in-a-simple-way-in-unity">Stack Overflow</a></p>
<h4 class="mume-header" id="waves-with-a-coroutine">Waves with a coroutine</h4>

<pre data-role="codeBlock" data-info="cs" class="language-csharp"><span class="token keyword">private</span> List<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> _times<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">Start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">SpawnWaves</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Regular old routine kicking off a special routine, one that can stop and start.</span>
<span class="token keyword">void</span> <span class="token function">SpawnWaves</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">// A list of intervals to wait. 0s for first, 4s for second, and so on.</span>
  List<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> times <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token generic-method"><span class="token function">List</span><span class="token punctuation">&lt;</span><span class="token keyword">float</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token number">0.0f</span><span class="token punctuation">,</span> <span class="token number">4.0f</span><span class="token punctuation">,</span> <span class="token number">2.5f</span><span class="token punctuation">,</span> <span class="token number">6.0f</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  
  <span class="token function">StartCoroutine</span><span class="token punctuation">(</span><span class="token function">ReleaseWaves</span><span class="token punctuation">(</span>times<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;This line will run right away&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// The unity engine needs to track these coroutines so we can do</span>
<span class="token comment">// things like start and top them. They need to be of type &quot;IEnumerator&quot;</span>
<span class="token comment">// for it to do that.</span>
<span class="token keyword">private</span> <span class="token class-name">IEnumerator</span> <span class="token function">ReleaseWaves</span><span class="token punctuation">(</span>List<span class="token operator">&lt;</span><span class="token keyword">float</span><span class="token operator">&gt;</span> waitTimes<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">// For each number of seconds to wait</span>
  <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token keyword">float</span> waitTime <span class="token keyword">in</span> waitTimes<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// Stop this function running until waitTime has ended</span>
    <span class="token keyword">yield</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">WaitForSeconds</span><span class="token punctuation">(</span>waitTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Then this code will run. Here&apos;s where I&apos;d spawn all the missiles</span>
    <span class="token comment">// in this particular wave, if I had a list of positions and angles.</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Waited for &quot;</span> <span class="token operator">+</span> waitTime <span class="token operator">+</span> <span class="token string">&quot; seconds&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Releasewaves done, signing off&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Call yield break; to end function, much like return</span>
  <span class="token keyword">yield</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</pre><hr>
<h4 class="mume-header" id="side-notes-on-coroutines-and-threads-for-the-curious">Side notes on coroutines and threads for the curious</h4>

<p>I didn&apos;t discuss threads above, but Unity c# does provide them.</p>
<p><strong>Coroutines</strong>: multiprocessing/multitasking within the main game engine loop/thread. Doesn&#x2019;t establish a system thread.</p>
<ul>
<li>
<p><strong>Pro</strong>: doesn&#x2019;t risk race conditions, threads corrupting data, easy to follow, allows multitasking. Before multi core processors and multithreaded applications,all multitasking was achieved like this. Most games still rely on single core performance like this.</p>
</li>
<li>
<p><strong>Con</strong>: not a true thread so can&#x2019;t run on a separate core for performance boost, will bog down all code if heavy</p>
</li>
</ul>
<p><strong>Coroutine and thread use cases</strong><br>
<strong>Coroutines:</strong> most simple timed operations inside component<br>
<strong>Threads:</strong> long intense operations like file save. Also used at higher levels for AI, path finding. If you&#x2019;ve studied threading. They are simple in concept and stupendously complex to syncronise/manage in real life. The bugs they generate are capricious in the extreme.</p>
<hr>
<h2 class="mume-header" id="missiles">Missiles</h2>

<p>Firing at targets. Maybe at the start of a wave all 3 volleys of missiles are aimed and prepped? If the city is destroyed before they arrive/fire so be it.</p>
<h3 class="mume-header" id="aiming-things-at-things">Aiming things at things</h3>

<p>Remember when we&apos;re doing trigenometry in a 2D plane, 0 rotation points us along the x axis to the right. Positive rotation goes anti clockwise.</p>
<ul>
<li>You want a sprite to point at things properly when rotation (theta &#x3B8;) is applied: lie them along the x axis.</li>
<li>Also <strong>use the Sprite Editor to set the pivot point</strong> of your rocket near where the hot gases are exiting.</li>
</ul>
<p><img src="assets/week11/orientation_for_trig_rotation.png" alt="orientation for trig rotation"></p>
<blockquote>
<p>Aiming it requires a target (mouse position in world space during click, see lecture 5 project i think), our rocket&apos;s position, and some math using <strong>distance, degrees to radians and atan2. Google some of those</strong> with the usual &quot;unity c#&quot; keywords added.</p>
</blockquote>
<hr>
<h3 class="mume-header" id="moving-at-a-given-speed">Moving at a given speed</h3>

<p>2D objects can&apos;t use transform.forward, because that&apos;s the Z axis. Use transform.right.</p>
<p>Use deltaTime (time since last frame) adapt your movments to the changing length of time each frame runs for. This will avoid jittery movement.</p>
<pre data-role="codeBlock" data-info="cs" class="language-csharp"><span class="token comment">// MissileAlien</span>
<span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">// Right is the x axis in trig. We travel along that.</span>
  <span class="token comment">// Any rotation of the object is applied after position, so</span>
  <span class="token comment">// we&apos;ll go whatever way the thing is pointing.</span>
  transform<span class="token punctuation">.</span>position <span class="token operator">+=</span> transform<span class="token punctuation">.</span>right <span class="token operator">*</span> Time<span class="token punctuation">.</span>deltaTime <span class="token operator">*</span> _speed<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre><hr>
<h3 class="mume-header" id="missile-explosions">Missile explosions</h3>

<ul>
<li>spawn where our rocket stops (ie where we clicked)</li>
<li>grow over time, with a collider, and listen for impacts.</li>
</ul>
<p>Explosions can be grown</p>
<ul>
<li>with unity animation tools</li>
<li>Lerp(linear interpolation/tweening)</li>
<li>just scaling over a series of frames in Update.</li>
</ul>
<hr>
<h3 class="mume-header" id="hitting-things">Hitting things</h3>

<p>Unity has a built in physics engine for this. We&apos;ll use it just to check if one sprite has contacted another, but not sign up for the actual physical action and reaction.</p>
<ul>
<li>Both objects need to have a <code>RigidBody2D</code> component</li>
<li>also a collider such as <code>BoxCollider2D</code> or <code>CircleCollider2D</code>. Add them via the inspector</li>
<li>set their Rigidbody Body Type to Kinematic</li>
<li>enable &quot;Use Full Kinematic Contacts&quot;. This lets us check for intersection of colliders without the smash and bounce.</li>
</ul>
<p>Any object with the setup above will have <code>OnCollisionEnter2D</code> called  if you define it. <code>Collider2D collision</code> will be passed in, filled with info about the collision and its participants.</p>
<pre data-role="codeBlock" data-info="cs" class="language-csharp"><span class="token comment">// In MissileAlien component</span>
<span class="token keyword">void</span> <span class="token function">OnCollisionEnter2D</span><span class="token punctuation">(</span> <span class="token class-name">Collision2D</span> collision <span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span>gameObject<span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">&quot; 2D Collided with &quot;</span> <span class="token operator">+</span> collision<span class="token punctuation">.</span>gameObject<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Use collision.GetContact to grab the collision point, </span>
    <span class="token comment">// Code here to instantiate AlienExplosionPrefab at that point</span>
    <span class="token comment">// Maybe throw an event about collision, passing the collided object?</span>
  <span class="token punctuation">}</span>

</pre>
      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>