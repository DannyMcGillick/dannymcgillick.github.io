<!DOCTYPE html><html><head>
      <title>week12_notes</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:///C:\Users\Danny\.vscode\extensions\shd101wyy.markdown-preview-enhanced-0.3.13\node_modules\@shd101wyy\mume\dependencies\katex\katex.min.css">
      
      
      
      
      
      
      
      
      

      <style> 
      pre{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;padding:1em;margin:.5em 0;overflow:auto;line-height:1.5;tab-size:4;hyphens:none;color:#c5c8c6;background-color:#27292c !important;border:#43484c;border-radius:3px}pre[class*="language-"]{padding:1em}code[class*="language-"] .token.comment,pre[class*="language-"] .token.comment,code[class*="language-"] .token.prolog,pre[class*="language-"] .token.prolog,code[class*="language-"] .token.doctype,pre[class*="language-"] .token.doctype,code[class*="language-"] .token.cdata,pre[class*="language-"] .token.cdata{color:#7C7C7C}code[class*="language-"] .token.punctuation,pre[class*="language-"] .token.punctuation{color:#96CBFE}code[class*="language-"] .namespace,pre[class*="language-"] .namespace{opacity:.7}code[class*="language-"] .token.constant,pre[class*="language-"] .token.constant{color:#99CC99}code[class*="language-"] .token.boolean,pre[class*="language-"] .token.boolean,code[class*="language-"] .token.number,pre[class*="language-"] .token.number,code[class*="language-"] .token.function-name,pre[class*="language-"] .token.function-name{color:#FF73FD}code[class*="language-"] .token.tag,pre[class*="language-"] .token.tag{color:#96CBFE}code[class*="language-"] .token.selector,pre[class*="language-"] .token.selector{color:#96CBFE}code[class*="language-"] .token.attr-name,pre[class*="language-"] .token.attr-name{color:#C6C5FE}code[class*="language-"] .token.string,pre[class*="language-"] .token.string{color:#A8FF60}code[class*="language-"] .token.char,pre[class*="language-"] .token.char{color:#FF8000}code[class*="language-"] .token.entity,pre[class*="language-"] .token.entity{color:#FFD2A7}code[class*="language-"] .token.url,pre[class*="language-"] .token.url{color:#7C7C7C}code[class*="language-"] .token.operator,pre[class*="language-"] .token.operator{color:#EDEDED}code[class*="language-"] .token.atrule,pre[class*="language-"] .token.atrule,code[class*="language-"] .token.attr-value,pre[class*="language-"] .token.attr-value,code[class*="language-"] .token.keyword,pre[class*="language-"] .token.keyword{color:#CFCB90}code[class*="language-"] .token.function,pre[class*="language-"] .token.function{color:#FFD2A7}code[class*="language-"] .token.class-name,pre[class*="language-"] .token.class-name{color:#FFD2A7}code[class*="language-"] .token.variable,pre[class*="language-"] .token.variable{color:#C6C5FE}code[class*="language-"] .token.regex,pre[class*="language-"] .token.regex,code[class*="language-"] .token.important,pre[class*="language-"] .token.important{color:#E9C062}code[class*="language-"] .token.important,pre[class*="language-"] .token.important,code[class*="language-"] .token.bold,pre[class*="language-"] .token.bold{font-weight:bold}code[class*="language-"] .token.italic,pre[class*="language-"] .token.italic{font-style:italic}code[class*="language-"] .token.entity,pre[class*="language-"] .token.entity{cursor:help}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:rgba(153,122,102,0.08);background:linear-gradient(to right, rgba(153,122,102,0.1) 70%, rgba(153,122,102,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:rgba(153,122,102,0.4);color:#f5f2f0;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px white}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#ccc;background-color:#141414;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#fff}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#a3a3a3}html body strong{color:#fff}html body del{color:#a3a3a3}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#a3a3a3;border-left:4px solid #3d3d3d}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#3d3d3d;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#fff}html body table td,html body table th{border:1px solid #3d3d3d;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#fff;background-color:#282828;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#3d3d3d;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#fff;border:1px solid #3d3d3d;border-bottom:2px solid #2e2e2e;padding:2px 4px;background-color:#282828;border-radius:3px}@media print{html body{background-color:#141414}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#fff;page-break-after:avoid}html body blockquote{color:#a3a3a3}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */
 
      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview   ">
      <h1 class="mume-header" id="week-12-performance-debugging">Week 12 - Performance, debugging</h1>

<div class="code-chunk" data-id="code-chunk-id-0" data-cmd="toc"><div class="input-div"><div class="btn-group"><div class="run-btn btn"><span>&#x25B6;&#xFE0E;</span></div><div class="run-all-btn btn">all</div></div><div class="status">running...</div></div><div class="output-div"></div></div><ul>
<li><a href="#week-12-performance-debugging">Week 12 - Performance, debugging</a>
<ul>
<li><a href="#resources">Resources</a></li>
<li><a href="#multi-argument-events">Multi argument events!</a>
<ul>
<li><a href="#example-of-action-with-2-arguments">Example of Action with 2 arguments</a>
<ul>
<li><a href="#prevnextitemonclickcs-partial">PrevNextItemOnClick.cs partial</a></li>
<li><a href="#customodelcs-partial">CustoModel.cs partial</a></li>
<li><a href="#quicky-how-did-you-get-the-string-dropdowns">Quicky: how did you get the string dropdowns</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 class="mume-header" id="resources">Resources</h2>

<ul>
<li>
<p>Events with multiple arguments</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.action-2?view=netframework-4.8">Microsoft docs for System.Action variants</a></li>
</ul>
</li>
<li>
<p>Unity 3D college on debugging:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=y3kqIlLzIig">https://www.youtube.com/watch?v=y3kqIlLzIig</a></li>
</ul>
</li>
<li>
<p>Unity Debugging video tute:</p>
<ul>
<li><a href="https://unity3d.com/learn/tutorials/topics/scripting/debugging-unity-games-visual-studio">https://unity3d.com/learn/tutorials/topics/scripting/debugging-unity-games-visual-studio</a></li>
</ul>
</li>
<li>
<p>Unity official: optimization garbage collection</p>
<ul>
<li><a href="https://unity3d.com/learn/tutorials/topics/performance-optimization/optimizing-garbage-collection-unity-games">https://unity3d.com/learn/tutorials/topics/performance-optimization/optimizing-garbage-collection-unity-games</a></li>
</ul>
</li>
</ul>
<hr>
<h2 class="mume-header" id="multi-argument-events">Multi argument events!</h2>

<p>Good news! During assessment marking I realised I was wrong about multiple arguments to our static events using <code>Action&lt;&gt;</code> and <code>delegate</code>! Luckily Gian looked into it harder, and I&#x2019;ll be updating the old course resources and my notes to show there are multiple overrides of Action.</p>
<p>You can specify argument counts with Action<t>, Action&lt;T1,T2&gt; and so on up to 16!</t></p>
<p><a href="https://docs.microsoft.com/en-us/dotnet/api/system.action-2?view=netframework-4.8">Microsoft docs for System.Action variants</a></p>
<h3 class="mume-header" id="example-of-action-with-2-arguments">Example of Action with 2 arguments</h3>

<p>Here&#x2019;s my inspector showing 2 arguments.</p>
<p><img src="assets/week12/prevNext_dropdowns_inspector.png" alt="PrevNext Item Inspector"></p>
<p>Here&#x2019;s the code to pass them in an event</p>
<h4 class="mume-header" id="prevnextitemonclickcs-partial">PrevNextItemOnClick.cs partial</h4>

<pre data-role="codeBlock" data-info="cs" class="language-csharp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrevNextItemOnClick</span> <span class="token punctuation">:</span> <span class="token class-name">MonoBehaviour</span>
<span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">event</span> Action<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token operator">&gt;</span> OnPrevNextRequested <span class="token operator">=</span> <span class="token keyword">delegate</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
   
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

  <span class="token keyword">void</span> <span class="token function">OnMouseClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token comment">// Now we can call with two strings</span>
    <span class="token function">OnPrevNextRequested</span><span class="token punctuation">(</span>_customItem<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _prevNext<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</pre><p>And to receive them</p>
<h4 class="mume-header" id="customodelcs-partial">CustoModel.cs partial</h4>

<pre data-role="codeBlock" data-info="cs" class="language-csharp"><span class="token comment">// Giving our handler to PrevNextItemOnClick doesn&apos;t change,</span>
<span class="token comment">// Just the signature of the handler</span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">OnPrevNextHandler</span><span class="token punctuation">(</span><span class="token keyword">string</span> item<span class="token punctuation">,</span> <span class="token keyword">string</span> prevOrNext<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    Debug<span class="token punctuation">.</span><span class="token function">Log</span><span class="token punctuation">(</span><span class="token string">&quot;Model heard arrow say &quot;</span> <span class="token operator">+</span> item <span class="token operator">+</span> <span class="token string">&quot;, &quot;</span> <span class="token operator">+</span> prevOrNext<span class="token punctuation">)</span><span class="token punctuation">;</span>
    charState<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>prevOrNext <span class="token operator">==</span> <span class="token string">&quot;previous&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> <span class="token function">decrementPosIntLooping</span><span class="token punctuation">(</span>charState<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">,</span> counts<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">incrementPosIntLooping</span><span class="token punctuation">(</span>charState<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">,</span> counts<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Then throw a modelUpdate event that lets peeps look at the state</span>
    <span class="token function">OnCharacterChanged</span><span class="token punctuation">(</span>charState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</pre><h4 class="mume-header" id="quicky-how-did-you-get-the-string-dropdowns">Quicky how did you get the string dropdowns</h4>

<p>I declared some enums, which we already know about. What you might not have discovered is the ToString() function you can call on them to get their defined name.</p>
<pre data-role="codeBlock" data-info="cs" class="language-csharp"><span class="token comment">// ... includes</span>

<span class="token keyword">public</span> <span class="token keyword">enum</span> PrevNext
<span class="token punctuation">{</span>
  previous<span class="token punctuation">,</span>
  next
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">enum</span> Customisable
<span class="token punctuation">{</span>
  hat<span class="token punctuation">,</span>
  face<span class="token punctuation">,</span>
  body
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrevNextItemOnClick</span> <span class="token punctuation">:</span> <span class="token class-name">MonoBehaviour</span>
<span class="token punctuation">{</span>
  <span class="token comment">// Declare a variable of enum&apos;s type, expose to editor with SerializeField</span>
  <span class="token punctuation">[</span><span class="token class-name">SerializeField</span><span class="token punctuation">]</span>
  <span class="token keyword">protected</span> <span class="token class-name">Customisable</span> _customItem<span class="token punctuation">;</span>

  <span class="token punctuation">[</span><span class="token class-name">SerializeField</span><span class="token punctuation">]</span>
  <span class="token keyword">protected</span> <span class="token class-name">PrevNext</span> _prevNext<span class="token punctuation">;</span>
  
  <span class="token comment">//... later in class:</span>
  
  <span class="token keyword">void</span> <span class="token function">OnMouseClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      <span class="token function">OnPrevNextRequested</span><span class="token punctuation">(</span>_customItem<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _prevNext<span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

</pre><h3 class="mume-header" id="joining-and-splitting-string-arguments">Joining and splitting string arguments</h3>

<p>I went with the first idea that came to mind for character customiser arrow clicks: typing <code>next</code> and <code>previous</code> into the inspector fields, then joining them in a string with a separator: <code>next_hat</code>. That was sent to the model, which split them apart.</p>
<pre data-role="codeBlock" data-info="cs" class="language-csharp"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">OnPrevNextHandler</span><span class="token punctuation">(</span><span class="token keyword">string</span> itemPrevOrNext<span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">string</span> item <span class="token operator">=</span> itemPrevOrNext<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> itemPrevOrNext<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;_&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">string</span> prevOrNext <span class="token operator">=</span> itemPrevOrNext<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span>itemPrevOrNext<span class="token punctuation">.</span><span class="token function">IndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;_&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    charState<span class="token punctuation">[</span>item<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>prevOrNext <span class="token operator">==</span> <span class="token string">&quot;previous&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">?</span> 
    
    <span class="token comment">// Go down or up, looping at extens</span>
    <span class="token function">decrementPosIntLooping</span><span class="token punctuation">(</span>charState<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">,</span> counts<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">incrementPosIntLooping</span><span class="token punctuation">(</span>charState<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">,</span> counts<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Then throw a modelUpdate event that lets peeps look at the state</span>
    <span class="token function">OnCharacterChanged</span><span class="token punctuation">(</span>charState<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</pre><p>It was an easy workaround for me because I&#x2019;ve chopped up strings in the past, but it has a few downsides:</p>
<ul>
<li>My version with text fields required looking up the right strings in the code.</li>
<li>Joining and splitting strings is pretty low cpu but it&#x2019;s still pointlessly wasteful.</li>
</ul>
<p>Inspector screen shot</p>
<pre data-role="codeBlock" data-info="cs" class="language-csharp"></pre><h3 class="mume-header" id="structs-and-objects">Structs and objects?</h3>

<p>Yep, you could just pass your own custom struct or object.</p>
<h2 class="mume-header" id="squashing-bugs">Squashing bugs</h2>

<p>The types of bugs in our code seem to be at least as numerous as the tools available to us. So far we&#x2019;ve had a pretty limited set of techniques for finding them: logging to console, running the build often, working in small scale/isolation when trying something out.</p>
<p>Eventually though, you get</p>
<ul>
<li>big games that are slow to build</li>
<li>things that can be only run amid complexity</li>
<li>restricted by the limits of the console</li>
</ul>
<h3 class="mume-header" id="enter-the-debugger">Enter the debugger</h3>

<p>A debugger is a shockingly powerful program that can look into the <strong>memory used by</strong> and <strong>execution of your program</strong> in real time. It can</p>
<ul>
<li>step over line by line,</li>
<li>*stop at breakpoints.</li>
<li>give you access to variable values as they&#x2019;re changed, including lists and objects, without console</li>
<li>often include a few performance stats</li>
</ul>
<p>Some of you will have used a debugger in say visual studio for c++/c sharp, or elsewhere for python. You might think</p>
<h3 class="mume-header" id="example-walk-through">Example walk through</h3>

<ul>
<li>Hearing a click in Character Customiser
<ul>
<li>See that it&#x2019;s called without needing debug.log</li>
<li>Look through passed arguments, look through object!</li>
</ul>
</li>
</ul>
<p>Coming pictures<br>
<strong>Attach Editor prefs unity</strong><br>
<strong>breakpoint picture</strong><br>
<strong>stopped at breakpoint</strong><br>
<strong>Inspecting variables</strong></p>
<h3 class="mume-header" id="where-to-break-how-to-step">Where to break, how to step</h3>

<p>Breaking, stepping over, stepping through.</p>
<h3 class="mume-header" id="now-do-it-with-your-project">Now do it with your project</h3>

<p>Try putting a break point at any of the following and exploring:</p>
<ul>
<li>When you catch a click and generate a missile</li>
<li>When a missile collider hits an explosion collider</li>
<li>Is a missile hitting your city but you can&#x2019;t see what&#x2019;s hitting it? Look at the colliders of each.</li>
<li>Updating score field: Why&#x2019;s it empty? Why are you getting a crash trying to change it? See if your variable referring to the component is null. See if the string you&#x2019;re creating from your score number is empty. Work out why later.</li>
</ul>
<h3 class="mume-header" id="forensic-debugging">Forensic debugging!</h3>

<p>So far we&#x2019;ve usually tried to debug by coming up with a theory and then putting in Console.Log. That only helps us if our theories are on point.</p>
<p>Using the debugger lets us look much more quickly at loads of things, gather loads of evidence, and a surprise result in that evidence can lead you to a bug source you&#x2019;d never considered.</p>
<hr>
<h2 class="mume-header" id="responsiveness">Responsiveness</h2>

<p>Missile Command: As wave after wave of death dealing alien hardware is flung at the homes and businesses of everyday earthlings, <strong>masses of resources are going into the creation of weapons and cleaning up in their aftermath.</strong></p>
<p>This describes life in the game, but also life for our game engine.</p>
<blockquote>
<p>We&#x2019;re instantiating human and alien missiles, trails and explosions for potentially hunderes of waves. Each one uses memory and processor time, and it takes time and effort for unity to recover resources when each is finished with.</p>
</blockquote>
<p>We often see failures of optimisations as constant low frame rates, or sudden frame drops.</p>
<h3 class="mume-header" id="limited-resources">Limited resources</h3>

<p>You might think about this much on quade core Windows machines with 16GB of RAM, but if you&#x2019;re outputting to other platforms this becomes critical</p>
<ul>
<li>Mobile phones/handhelds: Not much ram, not much processing power. Do not spend it all on disposable assets.</li>
<li>Console: At the start of a generation these specs seem pretty nice, but can become very constraining as people come to expect more.</li>
<li>VR users can be very sensitive to frame rate changes. If your game makes them sick, it doesn&#x2019;t matter how fun it is.</li>
</ul>
<h3 class="mume-header" id="manual-memory-management">Manual Memory Management</h3>

<p>What we had. Malloc, dealloc.</p>
<h2 class="mume-header" id="seeing-performance">Seeing Performance</h2>

<p>Profiler!<br>
Last week I gave you guys a function to move a missile over time, and it used time.elapsedTime to make sure things moved well regardless of how long frames took to render.<br>
Today we talked about how garbage collection can impact your game.</p>
<p><img src="assets/week12/profiler_cpu_frametime.png" alt="profiler cpu frames"></p>
<p>How can we visualise it?</p>
<h2 class="mume-header" id="optimising">Optimising</h2>

<p>How can we manage problems like big garbage collection hits and constant resource creation</p>
<h3 class="mume-header" id="garbage-collection">Garbage Collection</h3>

<p>Let the garbage man decide what&#x2019;s unwanted and take it away.</p>
<p>Obvious upside:<br>
Almost no manual memory management!</p>
<p>Dangers for the inexperienced: Garbage collection tends to take what would have been done manually, spread out over time, and lump it into passes.</p>
<ul>
<li>Fine if they&#x2019;re not cleaning up too much.</li>
<li>Give them a lot to clean up and like anyone else, they need time and resources. And that causes stutters in your game&#x2019;s frame rate and response.</li>
</ul>
<p><img src="assets/week12/garbage_collection_peaks.png" alt="GC Peaks"></p>
<h3 class="mume-header" id="object-pooling">Object pooling!</h3>

<p>Concept of object pooling.</p>
<h3 class="mume-header" id="implementation-of-object-pooling">implementation of object pooling?</h3>

<p>Go with simple example. Link to old mate.</p>

      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>